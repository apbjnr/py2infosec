#!/usr/bin/env python

import immlib

DESC = "processes.. sigh.."

def main(args):
    
    imm = immlib.Debugger()

## attach program to IM by specifying program location
    #imm.openProcess("C:\\Documents and Settings\\apb\\Desktop\\strcpy_server.exe")

## attach program to IM by specifying program process ID
    #imm.Attach(int(args[0]))

## create table with executable modules for attached process

    td = imm.createTable("Module Information", ['Name', 'Base', 'Entry', 'Size', 'Version']) 

    moduleList = imm.getAllModules()

    for entity in moduleList.values() :
        td.add(0, [ entity.getName(),
                    '%08X'%entity.getBaseAddress(),
                    '%08X'%entity.getEntry(),
                    '%08X'%entity.getSize(),
                    entity.getVersion()
                    ])

## get CPU registers        
    imm.log(str(imm.getRegs()))


    return "[+] ... sigh ...."
